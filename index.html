<html>
    <head>
        <link rel="stylesheet" type="text/css" href="style.css">
        <script>
            var id = 1;

            const userAction = async () => {
              var input = document.getElementById("userBox").value;
              document.getElementById("userBox").value = "";

              addMe(input,'sent',id++);
              const response = await fetch('http://localhost:8090', {
                method: 'POST',
                body: JSON.stringify({
                  q: input,
                  session_id: 'test',
                  lang: 'hi'
                }),
                headers:{
                  'Content-Type': 'application/json'
                }
              });
              const myJson = await response.json();
              // do something with myJson
              console.log(myJson);
              let res = myJson.queryResult.fulfillmentText;
              addMe(res,'received',id++);

            }

            function addMe(input,msgDetails,id){
              let chatContainer = document.getElementById("chatLog");

              chatContainer.innerHTML += '<div id="msg'+id+'" class="'+msgDetails+'">'+input+'</div>';

              //el=document.getElementById('msg'+id);
              // console.log(el)
               chatContainer.scrollTop = chatContainer.scrollHeight
              }

            function toggleView(){
                let inputBox = document.getElementById("userBox");
                let chatBox = document.getElementById('chatBox');
                let toggleView = document.getElementById('toggleView');
                console.log(toggleView.innerText);
                if(toggleView.innerText=='-'){
                  toggleView.innerText='^';
                  chatBox.style.height='50px';
                  inputBox.style.display='none';
                }else{
                  toggleView.innerText='-';
                  chatBox.style.height='450px';
                  inputBox.style.display='block';

                }
            }
        </script>
    </head>
    <body>
      <div id='chatBox' class="chat-box">
        <div class='chatbox-header'>
          <div class='label'>HindiBot</div>
          <button id='toggleView' class="toggle-view-btn" onclick='toggleView()'>-</button>
        </div>
        <input class='input-box' id="userBox" type="text" placeholder="Ask me.." onkeydown="if (event.keyCode == 13) {userAction()}">
        <div class='chat-container' id='chatLog'></div>
      </div>

    </body>
</html>
